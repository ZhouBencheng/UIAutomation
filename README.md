# AutoChat

## Supported Features

- 针对微信平台，支持将GUI解析为JSON结构和XML结构
- 获取屏幕截图，截图为所有滚动结束后的最终界面
- 支持识别可滚动控件`ListBox`，并将`ListBox`的中的所有条目滚动到可见区域并解析

## NOTE

关于静动态控件分类的标准，目前暂定以下两种判定条件

- `ListBox`中的`Item`一定是动态空间，因为在随机滚动后，不同的滚动场景中，处于可视化界面中的控件可能不同
- 随时间变化，位置（external data）和元数据（internal data）可能发生变化的是动态控件

构建exploration trace/history的流程如下

1. 制定任务，例如‘给XXX发送一条消息’
2. 调用`pywinauto`让微信自动完成任务
3. 在任务执行过程中，记录下所有的控件状态转移序列

## TODO

- [ ] 构造完成不同任务的状态转移序列
- [ ] 动态控件识别
- [ ] 对动态控件类型进行抽象汇总

## Vulnerabilities

- 目前可滚动控件仅对`ListBox`类型进行处理，其他类型的可滚动控件暂不支持
- 滚动控制不稳定，微信可能不响应`PGDN`，原因待定
- 目前提前滚动解析仅支持向下滚动到底，默认可滚动控件处于最顶端位置
- 在XML解析和JSON解析过程分离，导致需要重新解析可滚动控件，也就是在滚动解析完成后，需要重新滚动至顶准备下一次解析，后续可以将两者解析过程耦合